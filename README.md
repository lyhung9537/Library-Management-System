# Library Management System

## File Structure

- **hw2.cpp** Contains the main program loop, responsible for the main menu presentation and user interface management.

- **book.h** Defines the `Book` class, including attributes such as title, author, publication year, copies, and borrow count. It implements various operators and functions for sorting and comparison.

- **algo.h** Implements custom search and sort functionalities. It uses **Quick Sort** for general book sorting and **Merge Sort** to sort books by popularity (borrow count).

- **date.h** Provides the `Date` class for date calculations, such as adding days or months. The current date is displayed above every menu, and the system simulates time progression (advancing the date after every three main menu operations).

- **reader.h** Defines the `Reader` class, representing guests or registered users. This class manages account data, borrowing records, return deadlines, and violation history.
  - **Suspension:** If violation counts exceed 10, the account is prohibited from borrowing books.
  - **Redemption:** For users with violations, every 3 books donated will automatically clear 1 violation record.

---

## Features

### 1. Menu Functionalities

- **Guest Menu:**
  - **Search for a book:** Search by title, author, or publication year.
  - **List all books:** Display all books in the library inventory.
  - **Popularity ranking list:** Display books ranked by their borrow count.
  - **Login account:** Switch to a registered user account.
  - **Create account:** Register a new user account.
  - **Exit:** Exit the system.

- **User Menu (Logged-in):**
  - **Search for a book / List all books / Popularity ranking list**
  - **Add a new book:** Donate a new book to the library.
  - **Check out a book:** Borrow a book (borrowing period is 14 days).
  - **Return a book:** Return a borrowed book; records a violation if overdue.
  - **Check record:** View personal borrowing history and statistics.
  - **Log out:** Log out of the current account.
  - **Exit:** Exit the system.

### 2. Overdue Returns and Violation Handling
- Every borrowed book has a return deadline. If returned after the deadline:
  - The system prompts that the item is overdue.
  - The user's violation count increases.
- If total violations exceed 10, the user is prohibited from borrowing new books (account suspension).
- Users can clear violation records by donating books (3 donations = 1 violation cleared), regardless of suspension status.

### 3. Date Management
- The current date is displayed on every menu screen.
- The function `newDay()` simulates time progression (advancing 1 day for every 3 actions).
- Date arithmetic is used to calculate the return deadline (**Current Date + 14 days**) and to check for overdue status.

---

## Simulation Scenario 1: Basic Main Menu (I/O Demo)

Assume the program starts with a date generated by `randomDay()` (e.g., 2025/5/12) and the default user is "Guest".

```text
Date: 2025 / 5 / 12 
Hello, Guest. 
Library Management System
1. Search for a book
2. List all books
3. Popularity ranking list
4. Login account
5. Create account
6. Exit 

Enter option: 5
```

### Account Creation and Login

1. **Selecting '5' (Create account):**
   ```text
   Enter user ID: user01
   Enter password(less than 30 characters): ********
   Enter password again: ********
   Account successfully created.

   Press Enter to continue...
   ```

2. **Returning to the menu and selecting '4' (Login account):**
   ```text
   Library Management System
   ...
   Enter option: 4
   Enter user ID: user01
   Enter password: ********
   Login successful.
   Hello, user01.

   Press Enter to continue...
   ```

3. **User Mode Menu:**
   Once logged in, the menu switches to User Mode:
   ```text
   Library Management System
   1. Search for a book
   2. List all books
   3. Popularity ranking list
   4. Add a new book
   5. Check out a book
   6. Return a book
   7. Check record
   8. Log out
   9. Exit
   Enter option:
   ```

---

## Simulation Scenario 2: Adding a Book (Donation Demo)

This scenario demonstrates how the system handles a donation. If the book already exists, the system increments the copy count; otherwise, it adds a new entry and re-sorts the list.

### Input Process
The user (`user01`) selects '4' (Add a new book):
```text
Enter title: Clean Code 
Enter author: Robert C. Martin 
Enter publish year: 2008 
Thank you for your donation! ^ ^

Press Enter to continue...
```
- The system calls `User->increaseAdded()` to track the donation count.
- The system uses `func::find(Collection, book)` to check for existence:
  - If exists: Increment `copies`.
  - If not: Add the new `Book` and call `func::sort(Collection)` to maintain order.

---

## Simulation Scenario 3: Overdue Returns and Suspension

### Borrowing Process
The user (`user01`) selects '5' (Check out a book):
```text
Enter title: The C++ Primer 
Enter the author: Lippman 
Enter the year of publish: 2012
Book checked out successfully. 
Please return the book before 2025 / 5 / 26

Press Enter to continue...
```
- **Logic:** The system adds 14 days to the current date (2025/5/12) to set the deadline (2025/5/26).

### Returning Process (Overdue)
After several operations, the system date has advanced to 2025/6/01. The user selects '6' (Return a book):
```text
Enter title: The C++ Primer 
Enter the author: Lippman 
Enter the year of publish: 2012
Book returned successfully. 
Your returned item is overdue. 
Your account has recorded 1 violations. 
If your overdue returns exceed 10 times, your account will be permanently suspended.

Press Enter to continue...
```
- **Logic:** `Reader::isLate(today)` returns true because 2025/6/01 > 2025/5/26. Violation count is incremented.

### Suspension State
If the user reaches more than 10 violations and tries to borrow again:
```text
Enter option: 5
Your account has been suspended due to repeated infractions.

Press Enter to continue...
```

---

## Program Workflow Summary

1. **Initialization:** Sets a random starting date and starts in "Guest" mode.
2. **Authentication:** Users can register and log in to access user-specific features (donating, borrowing, returning).
3. **Core Logic:**
   - **Borrowing:** Checks for suspension status and calculates return deadlines.
   - **Returning:** Checks for overdue status and updates violation counts.
4. **Data Management:** Books are searchable by multiple criteria and can be sorted by popularity using custom sorting algorithms (Quick Sort / Merge Sort).
